{% extends 'blog/base.html' %}
{% load static %}

{% block content %}
<h2>Blog Posts</h2>

<!-- Search Bar -->
<form method="get" action="{% url 'posts' %}" style="margin-bottom: 20px;">
    <input type="text" name="q" placeholder="Search posts..." value="{{ request.GET.q }}">
    <button type="submit">Search</button>
</form>

<a href="{% url 'create_post' %}" class="btn">+ Create Post</a>

<ul>
    {% for post in posts %}
        <li>
            <h3>
                <a href="{% url 'post_detail' post.id %}">
                    {{ post.title }}
                </a>
            </h3>
            <p><strong>By:</strong> {{ post.author }}</p>
            <p>{{ post.content }}</p>

            <!-- Tags -->
            {% if post.tags.all %}
                <p>
                    <strong>Tags:</strong>
                    {% for tag in post.tags.all %}
                        <a href="{% url 'posts' %}?tag={{ tag.name|urlencode }}">{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
            {% endif %}
        </li>
    {% empty %}
        <li>No posts yet.</li>
    {% endfor %}
</ul>
{% endblock %}
